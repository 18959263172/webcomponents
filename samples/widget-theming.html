<!DOCTYPE html>
<html>
<head>
<title>Widget Theming: Shadow DOM Example</title>
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:700|Droid+Sans+Mono|Ovo" type="text/css">
<link rel="stylesheet" href="../assets/styles/main.css" type="text/css">
<link rel="stylesheet" href="../assets/styles/prettify.css" type="text/css" />
<script src="../assets/scripts/bug-assist.js"></script>
<script src="../assets/scripts/prettify.js"></script>
<meta name="bug.blocked" content="14956">
<meta name="bug.short_desc" content="[Samples]: ">
<meta name="bug.product" content="WebAppsWG">
<meta name="bug.component" content="Component Model">
</head>
<body>
<header>
<ul>
    <li><a href="../samples/index.html">Samples</a></li>
    <li><a href="../explainer/index.html">Explainer</a></li>
    <li><a href="../spec/shadow/index.html">Shadow DOM Spec</a></li>
    <li><a href="../spec/templates/index.html">HTML Templates</a></li>
</ul>
<h1>Contacts Widget</h1>
</header>

<p>After Raj's <a href="contacts-widget.html">discovery of Shadow DOM</a> triggered company-wide conversion to properly incapsulated widgets, Howard&mdash;not to be outdone&mdash;gleans another great opportunity in this change. He realizes that with the help of <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/semantics.html#attr-style-scoped">scoped stylesheets</a> and <a href="../spec/shadow/index.html">shadow DOM</a>, he can separate the general framing of the widgets from the theming code. For years now, it's been bugging him that whenever the widget's author wanted to tweak the general layout of their widgets, they would have edit the <code>/src/ui/layout/widgets.css</code> stylesheet and muck with their gubbins of code there, creating a waterfall of lines that looks like this:<p>
<pre class="prettyprint"><code>

/* General Widget properties */

.widget { &hellip; }

/* Contacts Widget layout. All rules must start with .contacts.widget  */

.contacts.widget ul {
    margin: 0;
    list-style: none;
    &hellip;
}

.contacts.widget ul li { &hellip; }

.contacts.widget ul li img.photo { &hellip; }

.contacts.widget ul li span.n { &hellip; }

&hellip;

/* Activity Stream Widget layout. All rules must start with .activity.widget */

.activity.widget ul { &hellip; }

.activity.widget li { &hellip; }

.activity.widget li.shared { &hellip; }

&hellip;

</code></pre>

<p>Then, a separate stylesheet in the <code>/src/ui/themes/</code> directory is used to apply colors, backgrounds, and all those wonderful barnacles that typically comprise a theme. Despite strictly enforced naming conventions, the structure is somewhat brittle and, on occasion, one rule clobbers another, subtly breaking the beautiful house of cards, causing users grief&mdash;and throwing Howard into panic mode. Panic mode gets old quickly.</p>

<p>Moving widget layout styles to <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/semantics.html#attr-style-scoped">scoped stylesheets</a> next to respective widgets goes a long way to make layout less brittle. Further, putting these scoped styles <em>inside</em> each widget's shadow DOM subtree ensures that the these styles are <strong>contained</strong> to the widgets. Sure, it's a bit of a refactoring, but that beats arguing with mom. Howard goes to work. An hour later, the <code>/src/ui/layout/widgets.css</code> stylesheet is drained and all widgets look like this (<code>/src/ui/widgets/contacts.js</code>, for example):</p>

<pre class="prettyprint"><code>
var ui = ui || {};
ui.widgets = ui.widgets || {};

(function() {
    var MAX_USERS = 8;

    function Contacts()
    {
        this.element = document.createElement('div');
        this.element.className = 'contacts widget';
        var shadow = new ShadowRoot(this.element);
        shadow.applyAuthorStyles = true;
        var users = shadow.appendChild(document.createElement('ul'));
        this.loadUsers(MAX_USERS, function(user) {
            var li = document.createElement('li');
            // Populate [li] with data from the [user] object.
            // &hellip;
        });
    }

    // &hellip;

    // Asynchronously loads users from server and invokes [callback] for each user loaded
    Contacts.prototype.loadUsers = function(userCount, callback)
    {
        // &hellip;
    }

    // &hellip;

    ui.widgets.Contacts = Contacts;

})();
</code></pre>

</body>
</html>




























